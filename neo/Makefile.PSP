PSPSDK=$(shell psp-config --pspsdk-path)
PSPBIN=$(shell psp-config --psp-prefix)/bin
MEDIA = /home/runner/work/dhewm3-psp/dhewm3-psp/bin/
TARGET = dhewm3

OBJS += \
	neo/cm/CollisionModel_contacts.o \	neo/cm/CollisionModel_contents.o \	neo/cm/CollisionModel_debug.o \	neo/cm/CollisionModel_files.o \	neo/cm/CollisionModel_load.o \	neo/cm/CollisionModel_rotate.o \	neo/cm/CollisionModel_trace.o \	neo/cm/CollisionModel_translate.o \	neo/framework/CmdSystem.o \	neo/framework/Common.o \	neo/framework/Compressor.o \	neo/framework/Console.o \	neo/framework/CVarSystem.o \	neo/framework/DeclAF.o \	neo/framework/DeclEntityDef.o \	neo/framework/DeclFX.o \	neo/framework/DeclManager.o \	neo/framework/DeclParticle.o \	neo/framework/DeclPDA.o \	neo/framework/DeclSkin.o \	neo/framework/DeclTable.o \	neo/framework/DemoFile.o \	neo/framework/EditField.o \	neo/framework/EventLoop.o \	neo/framework/File.o \	neo/framework/FileSystem.o \	neo/framework/KeyInput.o \	neo/framework/Session.o \	neo/framework/Session_menu.o \	neo/framework/UsercmdGen.o \	neo/framework/async/AsyncClient.o \	neo/framework/async/AsyncNetwork.o \	neo/framework/async/AsyncServer.o \	neo/framework/async/MsgChannel.o \	neo/framework/async/NetworkSystem.o \	neo/framework/async/ServerScan.o \	neo/framework/minizip/unzip.o \	neo/game/Actor.o \	neo/game/AF.o \	neo/game/AFEntity.o \	neo/game/BrittleFracture.o \	neo/game/Camera.o \	neo/game/EndLevel.o \	neo/game/Entity.o \	neo/game/Fx.o \	neo/game/GameEdit.o \	neo/game/Game_local.o \	neo/game/Game_network.o \	neo/game/IK.o \	neo/game/Item.o \	neo/game/Light.o \	neo/game/Misc.o \	neo/game/Moveable.o \	neo/game/Mover.o \	neo/game/MultiplayerGame.o \	neo/game/Player.o \	neo/game/PlayerIcon.o \	neo/game/PlayerView.o \	neo/game/Projectile.o \	neo/game/Pvs.o \	neo/game/SecurityCamera.o \	neo/game/SmokeParticles.o \	neo/game/Sound.o \	neo/game/Target.o \	neo/game/Trigger.o \	neo/game/Weapon.o \	neo/game/WorldSpawn.o \	neo/game/ai/AAS.o \	neo/game/ai/AAS_debug.o \	neo/game/ai/AAS_pathing.o \	neo/game/ai/AAS_routing.o \	neo/game/ai/AI.o \	neo/game/ai/AI_events.o \	neo/game/ai/AI_pathing.o \	neo/game/ai/AI_Vagary.o \	neo/game/anim/Anim.o \	neo/game/anim/Anim_Blend.o \	neo/game/anim/Anim_Import.o \	neo/game/anim/Anim_Testmodel.o \	neo/game/gamesys/Callbacks.o \	neo/game/gamesys/Class.o \	neo/game/gamesys/DebugGraph.o \	neo/game/gamesys/Event.o \	neo/game/gamesys/SaveGame.o \	neo/game/gamesys/SysCmds.o \	neo/game/gamesys/SysCvar.o \	neo/game/gamesys/TypeInfo.o \	neo/game/physics/Clip.o \	neo/game/physics/Force.o \	neo/game/physics/Force_Constant.o \	neo/game/physics/Force_Drag.o \	neo/game/physics/Force_Field.o \	neo/game/physics/Force_Spring.o \	neo/game/physics/Physics.o \	neo/game/physics/Physics_Actor.o \	neo/game/physics/Physics_AF.o \	neo/game/physics/Physics_Base.o \	neo/game/physics/Physics_Monster.o \	neo/game/physics/Physics_Parametric.o \	neo/game/physics/Physics_Player.o \	neo/game/physics/Physics_RigidBody.o \	neo/game/physics/Physics_Static.o \	neo/game/physics/Physics_StaticMulti.o \	neo/game/physics/Push.o \	neo/game/script/Script_Compiler.o \	neo/game/script/Script_Interpreter.o \	neo/game/script/Script_Program.o \	neo/game/script/Script_Thread.o \	neo/idlib/Base64.o \	neo/idlib/BitMsg.o \	neo/idlib/CmdArgs.o \	neo/idlib/Dict.o \	neo/idlib/Heap.o \	neo/idlib/LangDict.o \	neo/idlib/Lexer.o \	neo/idlib/Lib.o \	neo/idlib/MapFile.o \	neo/idlib/Parser.o \	neo/idlib/Str.o \	neo/idlib/Timer.o \	neo/idlib/Token.o \	neo/idlib/bv/Bounds.o \	neo/idlib/bv/Box.o \	neo/idlib/bv/Frustum.o \	neo/idlib/bv/Sphere.o \	neo/idlib/containers/HashIndex.o \	neo/idlib/geometry/DrawVert.o \	neo/idlib/geometry/JointTransform.o \	neo/idlib/geometry/Surface.o \	neo/idlib/geometry/Surface_Patch.o \	neo/idlib/geometry/Surface_Polytope.o \	neo/idlib/geometry/Surface_SweptSpline.o \	neo/idlib/geometry/TraceModel.o \	neo/idlib/geometry/Winding.o \	neo/idlib/geometry/Winding2D.o \	neo/idlib/hashing/CRC32.o \	neo/idlib/hashing/MD4.o \	neo/idlib/hashing/MD5.o \	neo/idlib/math/Angles.o \	neo/idlib/math/Complex.o \	neo/idlib/math/Lcp.o \	neo/idlib/math/Math.o \	neo/idlib/math/Matrix.o \	neo/idlib/math/Ode.o \	neo/idlib/math/Plane.o \	neo/idlib/math/Pluecker.o \	neo/idlib/math/Polynomial.o \	neo/idlib/math/Quat.o \	neo/idlib/math/Rotation.o \	neo/idlib/math/Simd.o \	neo/idlib/math/Simd_3DNow.o \	neo/idlib/math/Simd_AltiVec.o \	neo/idlib/math/Simd_Generic.o \	neo/idlib/math/Simd_MMX.o \	neo/idlib/math/Simd_SSE.o \	neo/idlib/math/Simd_SSE2.o \	neo/idlib/math/Simd_SSE3.o \	neo/idlib/math/Vector.o \	neo/MayaImport/maya_main.o \	neo/renderer/Cinematic.o \	neo/renderer/draw_arb2.o \	neo/renderer/draw_common.o \	neo/renderer/GuiModel.o \	neo/renderer/Image_files.o \	neo/renderer/Image_init.o \	neo/renderer/Image_load.o \	neo/renderer/Image_process.o \	neo/renderer/Image_program.o \	neo/renderer/Interaction.o \	neo/renderer/Material.o \	neo/renderer/MegaTexture.o \	neo/renderer/Model.o \	neo/renderer/ModelDecal.o \	neo/renderer/ModelManager.o \	neo/renderer/ModelOverlay.o \	neo/renderer/Model_ase.o \	neo/renderer/Model_beam.o \	neo/renderer/Model_liquid.o \	neo/renderer/Model_lwo.o \	neo/renderer/Model_ma.o \	neo/renderer/Model_md3.o \	neo/renderer/Model_md5.o \	neo/renderer/Model_prt.o \	neo/renderer/Model_sprite.o \	neo/renderer/RenderEntity.o \	neo/renderer/RenderSystem.o \	neo/renderer/RenderSystem_init.o \	neo/renderer/RenderWorld.o \	neo/renderer/RenderWorld_demo.o \	neo/renderer/RenderWorld_load.o \	neo/renderer/RenderWorld_portals.o \	neo/renderer/tr_backend.o \	neo/renderer/tr_deform.o \	neo/renderer/tr_font.o \	neo/renderer/tr_guisurf.o \	neo/renderer/tr_light.o \	neo/renderer/tr_lightrun.o \	neo/renderer/tr_main.o \	neo/renderer/tr_orderIndexes.o \	neo/renderer/tr_polytope.o \	neo/renderer/tr_render.o \	neo/renderer/tr_rendertools.o \	neo/renderer/tr_shadowbounds.o \	neo/renderer/tr_stencilshadow.o \	neo/renderer/tr_subview.o \	neo/renderer/tr_trace.o \	neo/renderer/tr_trisurf.o \	neo/renderer/tr_turboshadow.o \	neo/renderer/VertexCache.o \	neo/sound/snd_cache.o \	neo/sound/snd_decoder.o \	neo/sound/snd_efxfile.o \	neo/sound/snd_emitter.o \	neo/sound/snd_shader.o \	neo/sound/snd_system.o \	neo/sound/snd_wavefile.o \	neo/sound/snd_world.o \	neo/sys/cpu.o \	neo/sys/events.o \	neo/sys/glimp.o \	neo/sys/sys_local.o \	neo/sys/threads.o \	neo/sys/aros/aros_dedicated.o \	neo/sys/aros/aros_dos.o \	neo/sys/aros/aros_main.o \	neo/sys/aros/aros_net.o \	neo/sys/aros/aros_signal.o \	neo/sys/linux/main.o \	neo/sys/posix/posix_main.o \	neo/sys/posix/posix_net.o \	neo/sys/stub/openal_stub.o \	neo/sys/stub/stub_gl.o \	neo/TypeInfo/main.o \	neo/TypeInfo/TypeInfoGen.o \	neo/ui/BindWindow.o \	neo/ui/ChoiceWindow.o \	neo/ui/DeviceContext.o \	neo/ui/EditWindow.o \	neo/ui/FieldWindow.o \	neo/ui/GameBearShootWindow.o \	neo/ui/GameBustOutWindow.o \	neo/ui/GameSSDWindow.o \	neo/ui/GameWindow.o \	neo/ui/GuiScript.o \	neo/ui/ListGUI.o \	neo/ui/ListWindow.o \	neo/ui/MarkerWindow.o \	neo/ui/RegExp.o \	neo/ui/RenderWindow.o \	neo/ui/SimpleWindow.o \	neo/ui/SliderWindow.o \	neo/ui/UserInterface.o \	neo/ui/Window.o \	neo/ui/Winvar.o

LIBS = -lSDL -lGL -ljpeg -lvorbisfile -lvorbis -logg -lpspaudio -lpsphprm -lpsprtc -lpspvfpu -lpspirkeyb -lpsppower -lpspgu -lm -lstdc++ -lz

PSP = yes
BUILD_PRX = 0
PSP_FW_VERSION = 500
PSP_LARGE_MEMORY = 1

CFLAGS = -O2 -g -Wall --fast-math -D__PSP__ $(shell $(PSPBIN)/sdl-config --cflags) -I./game/
CFLAGS += -G0 -I/usr/local/pspdev/psp/include/SDL
CXXFLAGS = -fexceptions

EXTRA_TARGETS = EBOOT.PBP
PSP_EBOOT_TITLE = dhewm3
#PSP_EBOOT_ICON = ICON0.PNG
#PSP_EBOOT_UNKPNG = PIC0.PNG
#PSP_EBOOT_SND0 = SND0.AT3

include $(PSPSDK)/lib/build.mak

all: dhewm3

dhewm3: $(OBJS)
	$(CC) $(LIBS) $(OBJS) -o dhewm3
SRCS = \
	neo/sys/linux/main.cpp \

install:
	cp ./EBOOT.PBP $(MEDIA)$(TARGET)
dir:
	mkdir $(MEDIA)$(TARGET)
